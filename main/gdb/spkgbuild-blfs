# description	: The GNU Debugger (GDB)
# homepage	: https://www.gnu.org/software/gdb
# depends	: expat libmpfr readline texinfo xz zlib

name=gdb
version=13.2
release=2
source="https://ftp.gnu.org/gnu/$name/$name-$version.tar.xz"

build() {
	cd $name-$version

	mkdir build && cd build

	../configure --prefix=/usr \
		--with-system-readline \
		--with-system-zlib \
		--with-python=/usr/bin/python3 
	make
	make DESTDIR=$PKG install

	export PYTHONHASHSEED=0
	/usr/bin/python3 -m compileall -d /usr/share/gdb/python $PKG/usr/share/gdb/python
	/usr/bin/python3 -O -m compileall -d /usr/share/gdb/python $PKG/usr/share/gdb/python

	install -d $PKG/usr/share/man/man{1,5}
	install -m 0644 ../gdb/doc/*.1 $PKG/usr/share/man/man1
	install -m 0644 ../gdb/doc/*.5 $PKG/usr/share/man/man5

	rm -r $PKG/usr/{include,share/info}
	find $PKG \( -name '*.la' -o \
		-name '*.a' \) \
		-type f -delete
}
